---
title: "Econ Assignment 4"
author: "Quin Smith"
date: "5/22/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(ggpubr)
library(patchwork)
```

```{r}
#read data
dam <- read.csv(here("data/damages.csv"))
warm <- read.csv("data/warming.csv")
```

```{r}
#Question 1
#dam^2
dam <- dam %>% 
  mutate(warm2 = warming^2)

#dam_lm
dam_lm <- lm(damages ~ warming + warm2, data=dam)

dam_lm[["coefficients"]][["(Intercept)"]] <- 0

#plot
dam_plot <- ggplot(data=dam) +
  geom_point(aes(x=warming, y=damages)) +
  stat_smooth(data=dam_lm, aes(x=warming, y=damages)) +
  theme_bw()

dam_plot
```

```{r}
#Question 2
x <-dam_lm[["coefficients"]][["warming"]]
x2 <-dam_lm[["coefficients"]][["warm2"]]
int <-dam_lm[["coefficients"]][["(Intercept)"]]

warm <- warm %>% 
  mutate(dam_base = (warming_baseline*x) + (warming_baseline*x2) + int,
         dam_pulse = (warming_pulse*x) + (warming_pulse*x2) + int,
         dam_diff = ((warming_pulse-warming_baseline)*x) + 
           ((warming_pulse-warming_baseline)*x2) + int,
         dam_ton = dam_diff/35000000000)

#graphs
dam_base_plot <- ggplot()
```


